// 'deathline' jquery plugin. v1.0. author: orthener@i.ua
!function(a){a.fn.deathline=function(b){var c={datetime:null,format:null,callback:null},d=a.extend({},c,b);return this.each(function(){var b=a(this),c=function(){var c=Date.parse(d.datetime)/1e3,f=Math.floor(a.now()/1e3);if(c<=f)return null!=d.callback&&d.callback.call(this),void clearInterval(e);var g=c-f,h=Math.floor(g/86400);g-=60*h*60*24;var i=Math.floor(g/3600);g-=60*i*60;var j=Math.floor(g/60);g-=60*j;var k=h%10;1==k?b.find(".timeRefDays").text("день"):k>1&&k<5?b.find(".timeRefDays").text("дня"):b.find(".timeRefDays").text("дней");var l=i%10;1==l?b.find(".timeRefHours").text("час"):l>1&&l<5?b.find(".timeRefHours").text("часа"):b.find(".timeRefHours").text("часов");var m=j%10;1==m?b.find(".timeRefMinutes").text("минута"):m>1&&m<5?b.find(".timeRefMinutes").text("минуты"):b.find(".timeRefMinutes").text("минут");var n=g%10;1==n?b.find(".timeRefSeconds").text("секунда"):n>1&&n<5?b.find(".timeRefSeconds").text("секунды"):b.find(".timeRefSeconds").text("секунд"),"on"==d.format&&(h=String(h).length>=2?h:"0"+h,i=String(i).length>=2?i:"0"+i,j=String(j).length>=2?j:"0"+j,g=String(g).length>=2?g:"0"+g),isNaN(c)?(alert("Invalid date. Here's an example: 12 Tuesday 2012 17:30:00"),clearInterval(e)):(b.find(".days").text(h),b.find(".hours").text(i),b.find(".minutes").text(j),b.find(".seconds").text(g))},e=setInterval(c,1e3)})}}(jQuery);